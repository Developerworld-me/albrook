<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Style Sheets -->
<link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link href="https://fonts.googleapis.com/css?family=Crimson+Text|Work+Sans:400,700" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css">

<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/style.css') }}">

<!-- External Javascript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>

<script type="text/javascript" src="{{ url_for('static',filename='js/jqready.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/books.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/utils.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/modal.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/GET_api_calls.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/POST_api_calls.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static',filename='js/audio.js') }}"></script>

{% if current_user.is_authenticated %}
  <script type="text/javascript">
    var info = {{ info | tojson }};
    var numBooks = {{ numBooks }};
  </script>
{% endif %}
<script type="text/javascript">
  var prevPanel = -1;
  var Hide = true;
</script>

<html>
    <div id="infoBar">
      <div id="leftControls">
        <div class="row">
          <div class="tri-column">
            <button id="homeButton" class="navigationButton"><i class="fa fa-home" aria-hidden="true"></i></button>
          </div>
          <div class="tri-column">
            <button id="logOut" class="navigationButton" title="Log out {{ current_user.username }}"><i class="fa fa-sign-out" aria-hidden="true"></i></button>
          </div>
        </div>
      </div>
      <div id="rightControls">
        <!-- <input type="text" placeholder="Search.." id="search" style="width: 50%"> -->
      </div>
    </div>

    <div id="mainContainer">

      <div id="sideBar" class="sideBar">
          <h4 style="color: white;">Navigation</h4>
          <hr>
          <button class="navigationButton"><i class="fa fa-book" aria-hidden="true"></i>  Books</button><br>
          <button class="navigationButton"><i class="fa fa-pencil-square-o" aria-hidden="true"></i>  Authors</button><br>
          <button class="navigationButton"><i class="fa fa-archive" aria-hidden="true"></i>  Serise</button><br>
          <hr>
          <button class="navigationButton"><i class="fa fa-bookmark" aria-hidden="true"></i>  Bookmarks</button><br>
          <button class="navigationButton"><i class="fa fa-tags" aria-hidden="true"></i>  Tags</button><br>
          <hr>
          <a class="button navigationButton" href="#ex1" rel="modal:open"><i class="fa fa-user" aria-hidden="true"></i>  Account</a><br>
          <button class="navigationButton"><i class="fa fa-cogs" aria-hidden="true"></i>  Setting</button><br>
      </div>
      <div id="sideBarToggle">
        <div id="sideBarToggleShow">
          <!-- Side bar toggle line drawn here -->
        </div>
      </div>

      { % if forceLogin % }
        <script type="text/javascript">
          $(window).on('load',function(){
              $('#ex1').modal('show');
          });
        </script>
      { % endif % }

      <!-- Modal Dialouge -->
      <div id="ex1" class="modal">
        <form action="/User/login" method="post">
          <label for="uname"><b>Username</b></label>
          <input type="text" placeholder="Enter Username" name="uname" required>

          <label for="psw"><b>Password</b></label>
          <input type="password" placeholder="Enter Password" name="psw" required>

          <button type="submit">Login</button>
        </form>
      </div>

    {% if current_user.is_authenticated %}
      <div class="gallery">
        <div class="gelement" id="bookGallery">
          <ul id="rig">
            {% for book in range(1, numBooks+1) %}
              <li>
                  <div class="rig-cell" id="book_panel_{{ book }}">
                      <img class="rig-img" src="http://{{ request.host.split(':')[0] }}:5002/Book/{{ book }}/cover/thumbnail:500:500">
                      <span class="rig-overlay"></span>
                      <span class="rig-text" id="rig-text-{{ book }}"><i id="playIcon" class="fa fa-play-circle-o" aria-hidden="true"></i></span>
                  </div>
              </li>
            {% endfor %}
          </ul>
        </div>
        <div class="gelement" id="infoPane" style="max-height: 100%">
          <div id="infoText">
            <div id="infoHead">
              <div class="gallery" id="titleHeader">
                <h1 style="font-family:Crimson Text; margin: 2%;"><a id="infoTitle">Book Title Here</a></h1>
              </div>
              <h2 style="font-family:Crimson Text; margin: 2%;"><button id="infoAuthor" class="navigationButton" style="padding: 0;">Author Name</button></h2>
              <h2 style="font-family:Crimson Text; margin: 2%;"><a id="infoNarrator">Narrator Name</a></h2>
            </div>
            <!-- TODO => get text at bottom of div to fade -->
            <div style="height: 40%" id="infoContent">
              <div style="max-height: 60%; overflow: auto; margin: 2%; font-family:Crimson Text;" id="infoDesc">
                Description of Book
              </div>
              <div id="infoPhotoContainer" style="height: 40%; width: 40%; position: relative; left: 2%;">
                <img id="infoPhoto" src="{{ url_for('static',filename='img/bookPlaceHolder.png') }}" style="max-height: 100%; max-width: 100%;">
              </div>
            </div>
            <div id="infoFoot">
              <!-- Footer Info Here -->
            </div>
          </div>
        </div>
      </div>
    {% endif %}

      <br>
      <br>

      <div id="playPanelShowControlContainer">
        <button id="playPanelShowControl"><i class="fa fa-arrow-up"></i></button>
      </div>
      <div id="playPanel" class="bottomSlide">
        <div class="progress" id="progress"></div>
        <div id="shadowProgress"></div>
        <!-- <div id="progressSlider"></div> -->
        <audio id="Player" ontimeupdate="advance()">
          <source src="" id="audioSource">
        </audio>
        <div id="playControlsContainer" class="row">
          <div class="quint-column">
            <div class="auto-resize-portrait">
              <img src="{{ url_for('static',filename='img/bookPlaceHolder.png') }}" id="playingImage" align="left">
            </div>
          </div>
          <div id="leftPlayPanel" class="quint-column">
            <div class="gallery">
              <div class="gelement" id="CurrentStaticInfo">
                <p id="currentTitle">Title<br></p><p id="currentAuthor">Author</p>
              </div>
              <div class="gelement" id="CurrentDynamicInfo">
                <p id="currentChapter">Chapter</p>
              </div>
            </div>
          </div>
          <div class="quint-column" id="buttonContainer">
            <div class="intra_row">
              <div class="tri-column" onClick="playPrevChapter()" id="prevChapterSelect"><i class="fa fa-backward" aria-hidden="true"></i></div>
              <div id="togglePlay" onClick="togglePlay()" class="tri-column playControls"><i class="fa fa-play" aria-hidden="true"></i></div>
              <div class="tri-column" onClick="playNextChapter()" id="nextChapterSelect"><i class="fa fa-forward" aria-hidden="true"></i></div>
            </div>
          </div>

          <div id="rightPlayPanel" class="quint-column">
            <p>Right Content Here</p>
          </div>

          <div id="trackInfo" class="quint-column">
            <p id="percentCompeted">x/y</p>
          </div>
        </div>
      </div>
    </div>

</html>
